package cookbook.toptiles.core;

import pythagoras.f.MathUtil;

import playn.core.*;
import playn.core.util.Clock;
import static playn.core.PlayN.*;

public class TopTiles extends Game.Default {

  private final Clock.Source _clock = new Clock.Source(33);
  private final TileSheet _sheet = new TileSheet("images/tiles.png", 16, 16, 32, 32);
  private final Camera _camera = new Camera();
  private final TileView _view = new TileView(_sheet, _camera, 50, 37);

  public TopTiles() {
    super(33); // call update every 33ms (30 times per second)
  }

  @Override
  public void init() {
    // listen for keypresses
    keyboard().setListener(new Keyboard.Adapter() {
      @Override public void onKeyDown (Keyboard.Event event) {
        if (_camera.onKey(event.key(), true)) {
          // use prevent default to stop the web page from scrolling when arrow keys are pressed
          event.flags().setPreventDefault(true);
        }
      }
      @Override public void onKeyUp (Keyboard.Event event) {
        if (_camera.onKey(event.key(), false)) {
          event.flags().setPreventDefault(true);
        }
      }
    });

    // init our tile view
    _view.init(TILES);
  }

  @Override
  public void update(int delta) {
    _clock.update(delta);
  }

  @Override
  public void paint(float alpha) {
    _clock.paint(alpha);
    _camera.paint(_clock);
  }

  private static final int[] TILES = { // exported from editor
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 160, 161, 161, 161, 161, 161, 161, 161, 161, 161, 161, 161,
    161, 161, 161, 161, 162, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    176, 80, 81, 81, 82, 177, 177, 177, 177, 177, 177, 177, 177, 177, 177, 177, 178, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 96, 97, 97, 98, 177, 177, 177, 177,
    177, 177, 177, 177, 3, 5, 177, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 176, 96, 97, 97, 98, 177, 177, 177, 177, 177, 177, 177, 177, 19, 21, 177, 178, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 177, 112, 113, 113, 114, 177,
    177, 3, 4, 4, 4, 4, 4, 68, 21, 177, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 176, 177, 177, 177, 177, 177, 177, 19, 20, 20, 20, 20, 20, 20, 21, 177, 178, 163,
    163, 163, 163, 160, 161, 161, 161, 161, 161, 161, 161, 161, 161, 162, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 177, 177, 177, 177, 177,
    177, 19, 20, 20, 20, 20, 20, 20, 21, 177, 178, 163, 163, 163, 163, 176, 177, 86, 87, 87, 87, 88,
    177, 177, 177, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 176, 177, 6, 8, 177, 177, 177, 19, 20, 20, 20, 20, 20, 20, 21, 177, 178, 163, 163,
    163, 163, 176, 177, 102, 103, 103, 103, 104, 177, 177, 177, 178, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 177, 22, 24, 177, 177, 177, 19,
    20, 20, 20, 51, 36, 36, 37, 177, 178, 163, 163, 163, 163, 176, 177, 102, 103, 103, 103, 104, 177,
    177, 177, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 176, 177, 22, 24, 177, 177, 177, 19, 20, 20, 20, 21, 177, 177, 177, 177, 178, 163, 163,
    163, 163, 176, 177, 102, 103, 103, 103, 104, 177, 177, 177, 178, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 177, 22, 24, 177, 177, 177, 19,
    20, 20, 20, 21, 177, 177, 177, 177, 178, 163, 163, 163, 163, 176, 177, 118, 119, 119, 119, 120,
    177, 177, 177, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 176, 177, 22, 24, 177, 177, 177, 19, 20, 20, 20, 21, 177, 177, 177, 177, 178, 163,
    163, 163, 163, 192, 193, 193, 193, 193, 193, 193, 193, 193, 193, 194, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 177, 22, 24, 177, 177, 177,
    35, 36, 36, 36, 37, 177, 177, 177, 177, 178, 163, 163, 163, 163, 208, 209, 209, 209, 209, 209,
    209, 209, 209, 209, 210, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 176, 177, 38, 40, 177, 177, 177, 177, 177, 177, 177, 177, 177, 177, 177, 177,
    178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 192, 193, 193, 193,
    193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 194, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 208, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209,
    209, 209, 209, 209, 209, 210, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 160, 161, 161, 161, 161,
    161, 161, 161, 161, 161, 162, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 176, 80, 81, 81, 81, 81, 81, 81, 81, 82, 178, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 96, 97,
    97, 97, 97, 97, 97, 97, 98, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 176, 96, 97, 97, 128, 129, 97, 97, 97, 98, 178, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 96, 97,
    97, 144, 145, 97, 97, 146, 98, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 176, 96, 97, 97, 97, 97, 146, 97, 97, 98, 178, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176,
    96, 146, 97, 97, 97, 97, 97, 97, 98, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 96, 97, 97, 97, 97, 128, 129, 97, 98, 178, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    176, 96, 97, 97, 146, 97, 144, 145, 97, 98, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 176, 112, 113, 113, 113, 113, 113, 113,
    113, 114, 178, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 192, 193, 193, 193, 193, 193, 193, 193, 193, 193, 194, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 208, 209, 209,
    209, 209, 209, 209, 209, 209, 209, 210, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163,
    163, 163 };
}
